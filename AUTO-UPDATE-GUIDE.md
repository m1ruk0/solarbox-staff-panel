# 🚀 Инструкция по автообновлениям

## Как это работает

1. **При запуске приложения** - автоматически проверяется наличие обновлений на GitHub
2. **Если обновление найдено** - пользователь получает уведомление
3. **Пользователь выбирает** - скачать сейчас или позже
4. **Загрузка** - показывается прогресс в taskbar
5. **Установка** - при перезапуске приложения

## Как выпустить обновление

### 1. Обновите версию в package.json

```json
{
  "version": "1.0.1"  // Увеличьте версию
}
```

### 2. Соберите приложение

```bash
npm run build
```

Это создаст файлы в папке `dist/`:
- `SolarBox-Setup-1.0.1.exe` - установщик
- `latest.yml` - информация об обновлении

### 3. Создайте Release на GitHub

1. Перейдите на https://github.com/m1ruk0/solarbox-staff-panel/releases
2. Нажмите **"Create a new release"**
3. Заполните:
   - **Tag version:** `v1.0.1` (с буквой v!)
   - **Release title:** `Version 1.0.1`
   - **Description:** Что нового в этой версии
4. Загрузите файлы:
   - `SolarBox-Setup-1.0.1.exe`
   - `latest.yml`
5. Нажмите **"Publish release"**

### 4. Готово! 🎉

Теперь все пользователи при запуске приложения получат уведомление об обновлении!

## Что видит пользователь

### При наличии обновления:
```
┌─────────────────────────────────┐
│  Доступно обновление            │
│                                 │
│  Доступна новая версия 1.0.1    │
│  Хотите скачать и установить?   │
│                                 │
│  [Да]  [Позже]                  │
└─────────────────────────────────┘
```

### При загрузке:
- Прогресс-бар в taskbar
- Консоль показывает процент загрузки

### После загрузки:
```
┌─────────────────────────────────┐
│  Обновление готово              │
│                                 │
│  Обновление загружено и будет   │
│  установлено при перезапуске    │
│                                 │
│  [Перезапустить] [Позже]        │
└─────────────────────────────────┘
```

## Настройки автообновления

В `electron-main.js`:

```javascript
autoUpdater.autoDownload = false;        // Спрашивать перед загрузкой
autoUpdater.autoInstallOnAppQuit = true; // Устанавливать при выходе
```

## Отладка

Для тестирования в режиме разработки:

```javascript
// В electron-main.js уберите проверку app.isPackaged
autoUpdater.checkForUpdates(); // Всегда проверять
```

## Требования

- ✅ Репозиторий должен быть публичным на GitHub
- ✅ Версия в package.json должна быть больше предыдущей
- ✅ Release должен содержать `latest.yml` и `.exe`
- ✅ Tag должен начинаться с `v` (например, `v1.0.1`)

## Частые ошибки

### "No updates available"
- Проверьте, что версия в package.json больше текущей
- Убедитесь, что Release опубликован (не draft)

### "Error checking for updates"
- Проверьте настройки `publish` в package.json
- Убедитесь, что репозиторий публичный

### Приложение не обновляется
- Проверьте, что `latest.yml` загружен в Release
- Убедитесь, что пользователь запустил установщик (не portable версию)

## Альтернативные варианты

### Принудительное обновление
```javascript
autoUpdater.autoDownload = true; // Скачивать автоматически
```

### Проверка вручную
Добавьте кнопку "Проверить обновления" в меню приложения

---

**SolarBox Team** © 2025
